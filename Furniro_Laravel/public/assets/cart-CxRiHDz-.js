import{ad as C,A as w,o as v,c as _,e as t,f as i,w as l,g as u,i as B,j as P,k as S,t as c,y as q,B as T,x as m,h as $,b as p}from"./index-CRIHzQGb.js";import{_ as V}from"./trash-sogljgCe.js";const N={class:"poster d-flex mb-5"},A={key:0},Q=["src"],z={class:"text-center"},I=["onClick"],L={key:1},R={class:"bg-warning-7"},j={class:"px-5 mx-5"},D={class:"d-flex justify-content pt-5"},K={class:"ps-5 text-secondary"},E={class:"d-flex align-items-center py-3 pb-5"},F={class:"ps-5",style:{"font-size":"20px",color:"#b88e2f"}},M={__name:"cart",setup(H){const e=C();w(()=>e.getProductsInCart);const f=[{key:"image",label:""},{key:"title",label:"Product"},{key:"size",label:"Size"},{key:"price",label:"Price"},{key:"quantity",label:"Quantity",class:"text-center"},{key:"total",label:"Total"},{key:"actions",label:""}],g=(r,s)=>{const n=Number(s);if(isNaN(n)||n<1){e.removeAllProduct(r);return}const a=e.cartProducts[r];if(n>a.quantity){alert(`Chỉ còn ${a.quantity} sản phẩm trong kho`),a.cartQuantity=a.quantity,e.syncCartToServer();return}if(n>a.quantity){alert("Vượt quá số lượng tồn kho");return}a.cartQuantity=n,e.syncCartToServer()},b=r=>{["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Home","End"].includes(r.key)||/^[0-9]$/.test(r.key)||r.preventDefault()};return v(async()=>{await e.fetchCartFromServer(),console.log("Cart data:",e.getProductsInCart)}),(r,s)=>{const n=B,a=T,x=q,y=S,h=$,k=P;return p(),_("div",null,[t("section",N,[i(n,{class:"text-center py-5 my-5"},{default:l(()=>s[0]||(s[0]=[t("h1",null,"Shop",-1),t("div",{class:"mt-3"},[t("span",{class:"fw-bold"},"Home"),u(),t("span",null,">"),u(),t("span",null,"Shop")],-1)])),_:1})]),i(n,{class:"pb-5 mb-5"},{default:l(()=>[i(k,{class:"justify-content-between"},{default:l(()=>[i(y,{cols:"12",lg:"8",md:"8",sm:"8",class:""},{default:l(()=>[c(e).hasProduct?(p(),_("div",A,[i(x,{items:c(e).getCartItemsWithTotal,fields:f,"thead-class":"bg-warning-7","table-class":"my-table table-borderless align-middle "},{"cell(image)":l(o=>[t("img",{src:o.item.image,width:"100",height:"100"},null,8,Q)]),"cell(title)":l(o=>[u(m(o.item.product),1)]),"cell(price)":l(o=>[u(m((o.item.price_sale>0?o.item.price_sale:o.item.price).toLocaleString())+"đ ",1)]),"cell(quantity)":l(o=>[t("div",z,[i(a,{class:"mx-auto d-block",modelValue:c(e).cartProducts[o.index].cartQuantity,"onUpdate:modelValue":d=>c(e).cartProducts[o.index].cartQuantity=d,min:"1",onKeydown:b,onBlur:d=>g(o.index,d.target.value),style:{width:"43px",height:"42px","text-align":"center"},required:""},null,8,["modelValue","onUpdate:modelValue","onBlur"])])]),"cell(actions)":l(o=>[t("a",{onClick:d=>c(e).removeAllProduct(o.index)},s[1]||(s[1]=[t("img",{src:V,alt:""},null,-1)]),8,I)]),_:1},8,["items"])])):(p(),_("div",L,"Giỏ hàng trống."))]),_:1}),i(y,{cols:"12",lg:"4",md:"4",sm:"4",class:"text-center"},{default:l(()=>[t("div",R,[s[5]||(s[5]=t("h2",null,"Cart Totals",-1)),t("div",j,[t("div",D,[s[2]||(s[2]=t("b",null,"Subtotal:",-1)),t("p",K,"Rs"+m(c(e).totalPrice.toLocaleString()),1)]),t("div",E,[s[3]||(s[3]=t("b",null,"Total:",-1)),t("span",F," Rs"+m(c(e).totalPrice.toLocaleString()),1)]),i(h,{to:"/cart",onClick:c(e).togglePopupCart,class:"border-3 rounded-4 bg-warning-7 text-dark py-3 px-5 mb-5 align-items-center"},{default:l(()=>s[4]||(s[4]=[t("p",{class:"m-0",style:{"font-size":"20px"}},"CheckOut",-1)])),_:1},8,["onClick"])])])]),_:1})]),_:1})]),_:1})])}}};export{M as default};
